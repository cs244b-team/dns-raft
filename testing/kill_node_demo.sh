#!/bin/zsh
set -e

NODE_0_EXTERNAL_IP=34.168.204.145
NODE_1_EXTERNAL_IP=35.203.169.53
NODE_2_EXTERNAL_IP=35.203.184.108
NODE_3_EXTERNAL_IP=104.199.119.116
NODE_4_EXTERNAL_IP=35.233.157.154

NODES=(
    $NODE_0_EXTERNAL_IP
    $NODE_1_EXTERNAL_IP
    $NODE_2_EXTERNAL_IP
    $NODE_3_EXTERNAL_IP
    $NODE_4_EXTERNAL_IP
)

echo "Killing node-$1"
ssh -i ~/.ssh/id_ed25519_gh user@${NODES[$1]} -f \
'sudo kill -9 $(sudo lsof -t -i :53)' > /dev/null 2>&1
